(()=>{"use strict";var e={565:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:true});const o=r(718);class Client{constructor({webhookUrl:e,repositoryName:t,branchName:r,beforeRef:o}){this.webhookUrl=e;this.repositoryName=t;this.branchName=r;this.beforeRef=o}send(){if(!this.webhookUrl){console.error("webhookUrl is required");return}(0,o.execSync)("git --version");(0,o.execSync)('git config user.name "github-actions[bot]"');(0,o.execSync)('git config user.email "<>"');(0,o.execSync)("git status");const e=(0,o.execSync)(`git log ${this.beforeRef?`${this.beforeRef}..HEAD`:""} --pretty=format:"%h##%an##%s##%d##%ae" -30`).toString();const t=e.split("\n").map((e=>{const[t,r,o,s,n]=e.split("##");const a=s.match(/tag: ([^,)]+)/g);return{hash:t,author:r,message:o,tags:a,email:n}}));const r=new Date;const zeroPad=e=>e.toString().padStart(2,"0");const s=`${r.getFullYear()}.${zeroPad(r.getMonth()+1)}.${zeroPad(r.getDate())} ${zeroPad(r.getHours())}:${zeroPad(r.getMinutes())}`;const n={blocks:[{type:"section",text:{type:"mrkdwn",text:`*[${this.branchName}]* has been updated :rocket:`}},{type:"context",elements:[{type:"plain_text",text:`Branch: ${this.branchName}\nDate: ${s} :rocket:\nBy: ${t[0].author}`,emoji:true}]},{type:"divider"},{type:"context",elements:[{type:"mrkdwn",text:t.map((e=>{const t=`https://github.com/${this.repositoryName}/commit/`;return`${e.message} (<${t+e.hash}|${e.hash}> - ${e.author})`})).join("\n")}]}]};fetch(this.webhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({},n))}).then((e=>e.text())).then((e=>{console.log("slack response",e)}))}}t["default"]=Client},109:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:true});const s=o(r(565));const run=()=>{const e=process.env.SLACK_WEBHOOK_URL;const t=process.env.GITHUB_REPOSITORY;const r=process.env.GITHUB_REF_NAME;const o=process.env.BEFORE_REF;const n=new s.default({webhookUrl:e,beforeRef:o,repositoryName:t,branchName:r});n.send()};run()},718:e=>{e.exports=require("node:child_process")}};var t={};function __nccwpck_require__(r){var o=t[r];if(o!==undefined){return o.exports}var s=t[r]={exports:{}};var n=true;try{e[r].call(s.exports,s,s.exports,__nccwpck_require__);n=false}finally{if(n)delete t[r]}return s.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var r=__nccwpck_require__(109);module.exports=r})();